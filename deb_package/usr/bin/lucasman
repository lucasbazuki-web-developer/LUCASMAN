#!/usr/bin/env python3
import os
import subprocess
import sys
import time

def loading_screen():
    print("Cargando LUCASMAN...")
    for i in range(20):
        bar = "█" * (i + 1) + "░" * (19 - i)
        print(f"\r[{bar}] {i*5 + 5}%", end="")
        time.sleep(0.05)
    print("\n¡LUCASMAN cargado exitosamente!")

def show_logo():
    print("""
    ██╗     ██╗   ██╗ ██████╗ █████╗ ███████╗███╗   ███╗ █████╗ ███╗   ██╗
    ██║     ██║   ██║██╔════╝██╔══██╗██╔════╝████╗ ████║██╔══██╗████╗  ██║
    ██║     ██║   ██║██║     ███████║███████╗██╔████╔██║███████║██╔██╗ ██║
    ██║     ██║   ██║██║     ██╔══██║╚════██║██║╚██╔╝██║██╔══██║██║╚██╗██║
    ███████╗╚██████╔╝╚██████╗██║  ██║███████║██║ ╚═╝ ██║██║  ██║██║ ╚████║
    ╚══════╝ ╚═════╝  ╚═════╝╚═╝  ╚═╝╚══════╝╚═╝     ╚═╝╚═╝  ╚═╝╚═╝  ╚═══╝
    """)

def execute_command(cmd):
    try:
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
        if result.stdout:
            print(result.stdout)
        if result.stderr:
            print(result.stderr)
    except Exception as e:
        print(f"Error ejecutando comando: {e}")

def run_program():
    loading_screen()
    show_logo()
    while True:
        try:
            cmd = input("LUCASMAN> ").strip()
            if not cmd:
                continue
            if cmd.lower() == 'exit':
                print("Saliendo de LUCASMAN...")
                break
            elif cmd.lower() == 'shutdown':
                print("Ejecutando shutdown...")
                execute_command("sudo shutdown -h now")
            elif cmd.lower() == 'windows':
                print("Abriendo nueva ventana de terminal...")
                try:
                    subprocess.run(["xterm", "-title", "LUCASMAN Terminal"])
                except FileNotFoundError:
                    print("xterm no encontrado. Instala con 'sudo apt install xterm'")
            elif cmd.lower() == 'help':
                print("""
Comandos disponibles:
- ls: Listar archivos
- cd <dir>: Cambiar directorio
- pwd: Mostrar directorio actual
- clear: Limpiar pantalla
- shutdown: Apagar sistema
- windows: Abrir nueva terminal
- help: Mostrar esta ayuda
- exit: Salir
- Cualquier comando del sistema
                """)
            elif cmd.lower() == 'clear':
                os.system('clear')
            elif cmd.startswith('cd '):
                path = cmd[3:].strip()
                try:
                    os.chdir(path)
                    print(f"Directorio cambiado a: {os.getcwd()}")
                except FileNotFoundError:
                    print("Directorio no encontrado.")
                except Exception as e:
                    print(f"Error cambiando directorio: {e}")
            elif cmd == 'pwd':
                print(os.getcwd())
            else:
                # Ejecutar como comando del sistema
                execute_command(cmd)
        except KeyboardInterrupt:
            print("\nInterrupción detectada. Saliendo...")
            break
        except EOFError:
            print("\nFin de entrada. Saliendo...")
            break

def main():
    run_program()

if __name__ == "__main__":
    main()